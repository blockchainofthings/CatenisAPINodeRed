<script type="text/javascript">
    RED.nodes.registerType('send message', {
        category: 'catenis',
        color: '#a2a7cd',
        defaults: {
            name: { value: "" },
            fromDevice: { value: "", type: "catenis device" },
            toDeviceId: { value: "" },
            isProdUniqueId: { value: false },
            encoding: { value: "utf8" },
            storage: { value: "auto" },
            encrypt: { value: true },
            readConfirmation: { value: false }
        },
        inputs:1,
        outputs:1,
        icon: "file.png",
        label: function () {
            return this.name || "send message";
        }
    });
</script>

<script type="text/x-red" data-template-name="send message">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-row">
        <label for="node-input-fromDevice"><i class="fa fa-microchip"></i> Device</label>
        <input type="text" id="node-input-fromDevice">
    </div>
    <div class="form-row">
        <label for="node-input-toDeviceId"><i class="fa fa-microchip"></i> Target device ID</label>
        <input type="text" id="node-input-toDeviceId">
    </div>
    <div class="form-row">
        <label for="node-input-isProdUniqueId"><i class="fa fa-tag"></i> Product unique ID</label>
        <input type="checkbox" id="node-input-isProdUniqueId">
    </div>
    <div class="form-row">
        <label for="node-input-readConfirmation"><i class="fa fa-envelope"></i> Read confirmation</label>
        <input type="checkbox" id="node-input-readConfirmation">
    </div>
    <div class="form-row">
        <label for="node-input-encoding"><i class="fa fa-font"></i> Encoding</label>
        <select id="node-input-encoding">
            <option value="utf8" selected>UTF-8</option>
            <option value="base64">Base-64</option>
            <option value="hex">Hex</option>
        </select>
    </div>
    <div class="form-row">
        <label for="node-input-storage"><i class="fa fa-archive"></i> Storage</label>
        <select id="node-input-storage">
            <option value="auto" selected>Auto</option>
            <option value="embedded">Embedded</option>
            <option value="external">External</option>
        </select>
    </div>
    <div class="form-row">
        <label for="node-input-encrypt"><i class="fa fa-user-secret"></i> Encrypt</label>
        <input type="checkbox" id="node-input-encrypt">
    </div>
</script>

<script type="text/x-red" data-help-name="send message">
    <p>Call Catenis API to record a message to the blockchain directing it to another device.</p>
    <p>The configuration settings (except for Name and Device) are used to set the default for the corresponding parameters of the Catenis API end-point.</p>
    <p>The payload of the received message can be either a string or an object. If it is a string, its contents is used as the message to be logged and the default settings (as specified in the node’s configuration) are used for the other parameters.</p>
    <p>In case an object is received, the message and the options parameters are gotten from it. Any parameter present in the message payload supersedes the default settings (as specified in the node’s configuration).</p>
    <p>The data returned from a successful call to the Catenis API end-point are passed through the node’s single output.</p>
</script>
